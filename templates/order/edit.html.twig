
<!DOCTYPE html>
<html>
<head>
    <title>Редактирование заказа</title>
</head>
<body>
    <h1>Редактирование заказа: {{ order.id }}</h1>

    {{ form_start(form, {'attr': {'enctype': 'multipart/form-data'}}) }}
        {{ form_row(form.dish) }}
        {{ form_row(form.client) }}
        {{ form_row(form.uploadedFiles) }}

        {% if order.files %}
            <div style="margin-top: 20px;">
                <p><strong>Текущие файлы:</strong></p>
                <ul>
                    {% for file in order.files %}
                        <li>
                            <a href="{{ path('app_order_download_file', {'id': order.id, 'fileId': file.id}) }}">
                                Файл {{ loop.index }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        <div style="margin-top: 20px;">
            <button type="submit" class="btn btn-primary">Сохранить изменения</button>
            <a href="{{ path('app_order_index') }}" class="btn btn-secondary">Назад к списку</a>
        </div>
    {{ form_end(form) }}

    <div style="margin-top: 20px;">
        {% if order.files %}
            {% for file in order.files %}
                <div style="margin-bottom: 10px;">
                    Файл {{ loop.index }}
                    <form method="post" action="{{ path('app_order_delete_file', {'id': order.id, 'fileId': file.id}) }}" 
                          style="display: inline;"
                          onsubmit="return confirm('Удалить этот файл?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete-file-' ~ file.id) }}">
                        <button type="submit" class="btn btn-danger btn-sm">Удалить файл</button>
                    </form>
                </div>
            {% endfor %}
        {% endif %}

        <form method="post" action="{{ path('app_order_delete', {'id': order.id}) }}" 
              style="margin-top: 10px;"
              onsubmit="return confirm('Удалить этот заказ?');">
            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ order.id) }}">
            <button type="submit" class="btn btn-danger">Удалить заказ</button>
        </form>
    </div>
</body>
</html>
